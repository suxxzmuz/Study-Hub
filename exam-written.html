<!-- ì§€í•„í‰ê°€ ì‹œê°„í‘œ -->
<!-- ì¤‘ê°„/ê¸°ë§ê³ ì‚¬ ë“±ì˜ ì§€í•„í‰ê°€ ì¼ì •ì„ í‘œì‹œí•˜ëŠ” í™”ë©´ -->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Written Test Timetable</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style> 
        /* ---------------------------------------------------- */
        /* 1. ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ë ˆì´ì•„ì›ƒ (ë¬´ì±„ìƒ‰ ê¸°ë°˜) */
        /* ---------------------------------------------------- */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7;
            color: #333;
        }

        #pp {
            max-width: 650px; 
            width: 100%;
            margin: 0 auto;
            padding: 0 15px;
        }

        .card-box {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e0e0e0; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        h1 {
            color: #212121;
            margin: 30px 0 20px 0;
            text-align: center;
            font-weight: 700;
        }

        .exam-block {
            background-color: #ffffff;
            border: 1px solid #cccccc;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
        }

        /* ---------------------------------------------------- */
        /* 2. í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            margin-top: 10px;
        }

        table, td, th {
            border: 1px solid #999999;
            text-align: center;
        }

        td {
            height: 45px;
            vertical-align: middle;
            word-break: break-word;
        }

        th {
            background-color: #e0e0e0; 
            padding: 10px 8px;
            font-size: 1rem;
            text-align: center;
            color: #212121;
        }

        /* ---------------------------------------------------- */
        /* 3. ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        input[type="date"],
        input[type="text"] {
            width: 100%;
            font-size: 15px;
            text-align: center;
            border: none;
            background-color: transparent; 
        }
        
        .exam-date {
            padding: 6px 10px !important;
            border: 1px solid #cccccc;
            border-radius: 4px;
            background-color: #f0f0f0 !important;
        }

        td input[type="text"] {
            width: 100%;
            font-size: 0.95rem;
            padding: 6px;
            text-align: center;
            line-height: 1.2;
        }

        /* ---------------------------------------------------- */
        /* 4. ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0 50px 0;
            flex-wrap: wrap;
        }
        
        .buttons button {
            flex-grow: 1; 
            min-width: 120px;
            padding: 10px 15px;
            font-size: 1rem;
            border: 1px solid #555555;
            background-color: #ffffff; 
            color: #212121;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-weight: 500;
            max-width: 160px; 
        }
        
        .buttons button:hover {
            background-color: #f0f0f0;
        }
        
        .buttons button i {
            font-size: 1.2rem;
            margin-right: 5px; 
        }
        
        .exam-block button:not([onclick^="removeExamBlock"]) {
            float: right;
            margin-top: 15px;
            padding: 8px 15px;
            font-size: 0.9rem;
            border: 1px solid #555555;
            background-color: #f0f0f0;
        }
        
        .exam-block button:hover:not([onclick^="removeExamBlock"]) {
            background-color: #dddddd;
        }
        
        .exam-block button[onclick^="removeExamBlock"] {
            float: none; 
            margin: 0; 
            padding: 4px 8px; 
            font-size: 0.85rem; 
            border: none; 
            background: transparent;
            cursor: pointer;
        }

    </style>
</head>
<body>
    <div id='pp'>
    <h1>ğŸ“ ì§€í•„í‰ê°€ ì‹œê°„í‘œ</h1>

    <div id="examContainer"></div>

    <div class="buttons">
        <button id="addDateBtn" title="ë‚ ì§œ ë¸”ë¡ ì¶”ê°€">
            <i class="fas fa-calendar-plus"></i> ë‚ ì§œ ì¶”ê°€
        </button>
        <button id="goHomeBtn" title="ë©”ì¸ í™”ë©´ìœ¼ë¡œ">
            <i class="fas fa-home"></i> ë©”ì¸ í™”ë©´
        </button>
        <button id="clearExamBtn" title="ì „ì²´ ì´ˆê¸°í™”">
            <i class="fas fa-redo-alt"></i> ì´ˆê¸°í™”
        </button>
        <button id="saveExamBtn" title="ì €ì¥">
            <i class="fas fa-save"></i> ì €ì¥
        </button>
    </div>

    <datalist id="exam-subject">
        <option value="ë…ì„œ"><option value="ë¬¸í•™"><option value="ìˆ˜í•™I"><option value="ìˆ˜í•™II">
        <option value="ì˜ì–´I"><option value="ì˜ì–´II"><option value="í•œêµ­ì‚¬"><option value="ì²´ìœ¡">
        <option value="í™•ë¥ ê³¼ í†µê³„"><option value="ê¸°í•˜"><option value="ìƒí™œê³¼ ìœ¤ë¦¬"><option value="ì •ì¹˜ì™€ ë²•">
        <option value="í•œêµ­ì§€ë¦¬"><option value="ê³ ì „ê³¼ ìœ¤ë¦¬"><option value="ì—¬í–‰ì§€ë¦¬"><option value="ë¬¼ë¦¬í•™I">
        <option value="í™”í•™I"><option value="ìƒëª…ê³¼í•™I"><option value="ì§€êµ¬ê³¼í•™I"><option value="ìƒíƒœì™€ í™˜ê²½">
        <option value="ì •ë³´"><option value="ê°€ì •ê³¼í•™"><option value="ì¼ë³¸ì–´I"> 
    </datalist>

    <script>
        let blockCount = 0;

        /** ì‹œí—˜ ë¸”ë¡ ìƒì„± ë° ë Œë”ë§ */
        function createExamBlock(dateValue = "", rows = 3, subjects = []) {
            const blockId = `exam-block-${blockCount++}`;
            const container = document.getElementById("examContainer");

            const block = document.createElement("div");
            block.className = "exam-block";
            block.id = blockId;

            block.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label for="exam-date-${blockId}" style="font-weight: bold; color: #555;">ğŸ“… ë‚ ì§œ:</label>
                        <input type="date" class="exam-date" id="exam-date-${blockId}" value="${dateValue}" style="flex: 1;">
                    </div>
                    <button onclick="removeExamBlock('${blockId}')" title="ì´ ë‚ ì§œ ë¸”ë¡ ì‚­ì œ">
                         <i class="fas fa-trash-alt" style="color: #cc0000;"></i> 
                    </button>
                </div>
                <table style="width: 100%; table-layout: fixed;">
                    <colgroup>
                        <col style="width: 30%;">
                        <col style="width: 70%;">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>ê³¼ëª©</th>
                            <th>ì‹œí—˜ ë²”ìœ„</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Array.from({ length: rows }, (_, i) => `
                            <tr>
                                <td>
                                    <input type="text" list="exam-subject" value="${subjects[i]?.subject || ""}" placeholder="ê³¼ëª© ì„ íƒ" style="width: 95%;">
                                </td>
                                <td>
                                    <input type="text" value="${subjects[i]?.range || ""}" placeholder="ì‹œí—˜ ë²”ìœ„ ì…ë ¥">
                                </td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
                <div style="text-align: right; overflow: hidden;">
                    <button onclick="addExamRow('${blockId}')">â• ì‹œí—˜ ì¶”ê°€</button>
                </div>
            `;

            container.appendChild(block);
        }

        /** ë‚ ì§œ ë¸”ë¡ ì œê±° */
        function removeExamBlock(blockId) {
             if (confirm("ì´ ë‚ ì§œ ë¸”ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                const block = document.getElementById(blockId);
                if (block) {
                    block.remove();
                    // saveExam(); // ì‚­ì œ í›„ ìë™ ì €ì¥ì€ ì‚¬ìš©ìê°€ ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆì–´ ì£¼ì„ ì²˜ë¦¬
                }
             }
        }
        
        /** í…Œì´ë¸” í–‰ ì¶”ê°€ */
        function addExamRow(blockId) {
            const tbody = document.querySelector(`#${blockId} table tbody`);
            const newRow = document.createElement("tr");
            newRow.innerHTML = `
                <td><input type="text" list="exam-subject" placeholder="ê³¼ëª© ì„ íƒ" style="width: 95%;"></td>
                <td><input type="text" placeholder="ì‹œí—˜ ë²”ìœ„ ì…ë ¥"></td>
            `;
            tbody.appendChild(newRow);
        }

        /** ë‚ ì§œ ë¸”ë¡ ì¶”ê°€ ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬ */
        function addDateBlock() {
            createExamBlock();
        }

        /** ëª¨ë“  ë°ì´í„° ì €ì¥ */
        function saveExam() {
            const blocks = document.querySelectorAll(".exam-block");
            const data = Array.from(blocks).map(block => {
                const date = block.querySelector(".exam-date").value;
                const rows = block.querySelectorAll("tbody tr");
                const subjects = Array.from(rows).map(row => {
                    const inputs = row.querySelectorAll("input[type='text']");
                    return {
                        subject: inputs[0] ? inputs[0].value : "",
                        range: inputs[1] ? inputs[1].value : ""
                    };
                }).filter(s => s.subject || s.range); 
                
                return { date, subjects };
            }).filter(d => d.date || d.subjects.length > 0); 

            localStorage.setItem("examData", JSON.stringify(data));
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
        }

        /** ì „ì²´ ë°ì´í„° ì´ˆê¸°í™” */
        function clearExam() {
            if (confirm("ì§€í•„í‰ê°€ ì‹œê°„í‘œë¥¼ ëª¨ë‘ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì €ì¥ëœ ëª¨ë“  ë°ì´í„° ì‚­ì œ)")) {
                document.getElementById("examContainer").innerHTML = "";
                localStorage.removeItem("examData");
                alert("ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
                // ê¸°ë³¸ 3ê°œ ë‹¤ì‹œ ìƒì„±
                for (let i = 0; i < 3; i++) createExamBlock();
            }
        }
        
        /** ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™ */
        function goHome() {
            window.location.href = 'index.html';
        }

        /** í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì´ë²¤íŠ¸ ì—°ê²° */
        window.onload = function () {
            const saved = localStorage.getItem("examData");
            if (saved) {
                const data = JSON.parse(saved);
                data.forEach(entry => {
                    createExamBlock(entry.date, entry.subjects.length, entry.subjects);
                });
            } else {
                // ì²˜ìŒ ë¡œë“œ ì‹œ 3ê°œ ìƒì„±
                for (let i = 0; i < 3; i++) createExamBlock();
            }
            
            // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°
            const addDateBtn = document.getElementById('addDateBtn');
            if (addDateBtn) addDateBtn.addEventListener('click', addDateBlock);

            const saveBtn = document.getElementById('saveExamBtn');
            if (saveBtn) saveBtn.addEventListener('click', saveExam);

            const clearBtn = document.getElementById('clearExamBtn');
            if (clearBtn) clearBtn.addEventListener('click', clearExam);

            const homeBtn = document.getElementById('goHomeBtn');
            if (homeBtn) homeBtn.addEventListener('click', goHome);
        };
    </script>
</body>
</html>