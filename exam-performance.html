<!-- ìˆ˜í–‰í‰ê°€ ì‹œê°„í‘œ -->
<!-- ê³¼ëª©ë³„ ìˆ˜í–‰í‰ê°€ ì¼ì • ë° ë§ˆê°ì¼ì„ ë³´ì—¬ì£¼ëŠ” í™”ë©´ -->

<!-- ìˆ˜ì • ëª©ë¡ -->
<!-- ë…„/ì›” í‘œì‹œ ì–‘ ì˜†ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” ë²„íŠ¼ í¬ê¸° ì¡°ì ˆí•˜ê¸°  -->
<!-- -->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Performance Assessment Schedule</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* ---------------------------------------------------- */
        /* 1. ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ë ˆì´ì•„ì›ƒ  */
        /* ---------------------------------------------------- */
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7; 
            color: #333;
            text-align: center;
        }

        #pp {
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 0 15px;
        }

        .card-box {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e0e0e0; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        h1 { 
            font-size: 1.6rem;
            color: #212121; 
            margin: 25px 0 20px 0;
        }

        /* ---------------------------------------------------- */
        /* 2. ë‹¬ë ¥ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        .buttons { margin: 15px 0; }

        #monthYear {
            font-size: 1.1rem;
            font-weight: bold;
            margin: 0 15px;
            color: #212121;
        }

        table.calendar {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        table.calendar th, table.calendar td {
            border: 1px solid #999;
            width: 14.28%;
            height: 90px;
            vertical-align: top;
            position: relative;
            padding: 5px;
            font-size: 14px;
            cursor: pointer;
        }

        table.calendar th {
            background-color: #e0e0e0;
            height: 40px;
            vertical-align: middle;
            text-align: center;
            color: #212121;
        }
        
        table.calendar th:first-child,
        table.calendar td:nth-child(1) {
            color: #d63031;
        }
        
        table.calendar th:last-child,
        table.calendar td:nth-child(7) {
            color: #0984e3; 
        }

        .dot {
            width: 20px;
            height: 20px;
            background-color: #212121;
            border-radius: 50%;
            color: white;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 4px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .today {
            background-color: #fffacd;
            border: 2px solid #555555;
            font-weight: bold;
        }

        /* ---------------------------------------------------- */
        /* 3. í‰ê°€ í•­ëª© ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        .entry-card {
            background-color: #ffffff;
            border: 1px solid #cccccc;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px auto;
            max-width: 600px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            text-align: left;
        }

        .entry-line {
            margin: 5px 0;
            font-size: 15px;
            line-height: 1.4;
        }

        /* ---------------------------------------------------- */
        /* 4. ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------------------------- */
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0 50px 0;
            flex-wrap: wrap;
        }
        
        .buttons button {
            flex-grow: 1; 
            min-width: 1px;
            padding: 10px 15px;
            font-size: 1rem;
            border: 1px solid #555555;
            background-color: #ffffff; 
            color: #212121;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-weight: 500;
            max-width: 12px;
        }

        .buttons button:hover {
            background-color: #f0f0f0;
        }
        
        .buttons button i {
            margin-right: 5px;
        }

    </style>
</head>
<body>
    <div id='pp'>
        <div class="section" id="timetable-box"></div>
        <h1>ğŸ“˜ ìˆ˜í–‰í‰ê°€ ì¼ì •í‘œ</h1>

        <div class="buttons">
            <button id="prevMonthBtn">
                <i class="fas fa-chevron-left"></i> ì´ì „ ë‹¬
            </button>
            <span id="monthYear"></span>
            <button id="nextMonthBtn">
                ë‹¤ìŒ ë‹¬ <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <table class="calendar" id="calendar"></table>

        <div id="evaluations"></div>

        <div class="buttons">
            <button id="saveDataBtn" title="ì €ì¥">
                <i class="fas fa-save"></i> ì €ì¥
            </button>
            <button id="clearDataBtn" title="ì „ì²´ ì´ˆê¸°í™”">
                <i class="fas fa-redo-alt"></i> ì´ˆê¸°í™”
            </button>
            <button id="goHomeBtn" title="ë©”ì¸ í™”ë©´ìœ¼ë¡œ">
                <i class="fas fa-home"></i> ë©”ì¸ í™”ë©´
            </button>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        let data = {};

        const subjectToEmoji = (subject) => {
            const map = {
                "ë…ì„œ": "ğŸ“–", "ë¬¸í•™": "âœ’", "ìˆ˜í•™I": "â—", "ìˆ˜í•™II": "âœ–",
                "ì˜ì–´I": "ğŸ‡ºğŸ‡¸", "ì˜ì–´II": "ğŸ—£", "í•œêµ­ì‚¬": "ğŸ¯", "ì²´ìœ¡": "ğŸƒ",
                "í™•ë¥ ê³¼ í†µê³„": "ğŸ“Š", "ê¸°í•˜": "ğŸ“", "ìƒí™œê³¼ ìœ¤ë¦¬": "ğŸ§ ",
                "ì •ì¹˜ì™€ ë²•": "âš–", "í•œêµ­ì§€ë¦¬": "ğŸ—º", "ê³ ì „ê³¼ ìœ¤ë¦¬": "ğŸ“š",
                "ì—¬í–‰ì§€ë¦¬": "âœˆï¸", "ë¬¼ë¦¬í•™I": "ğŸ§²", "í™”í•™I": "âš—", "ìƒëª…ê³¼í•™I": "ğŸ§¬",
                "ì§€êµ¬ê³¼í•™I": "ğŸŒ", "ìƒíƒœì™€ í™˜ê²½": "ğŸŒ¿", "ì •ë³´": "ğŸ’»",
                "ê°€ì •ê³¼í•™": "ğŸ³", "ì¼ë³¸ì–´I": "ğŸ‡¯ğŸ‡µ"
            };
            return map[subject] || "ğŸ“˜";
        };

        function renderCalendar() {
            const calendar = document.getElementById("calendar");
            const monthYear = document.getElementById("monthYear");

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            const today = new Date();
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();

            monthYear.textContent = `${year}ë…„ ${month + 1}ì›”`;

            let html = '<tr>';
            const weekDays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            weekDays.forEach(d => html += `<th>${d}</th>`);
            html += '</tr><tr>';

            for (let i = 0; i < firstDay; i++) html += '<td></td>';

            for (let day = 1; day <= lastDate; day++) {
                const fullDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const hasEval = data[fullDate];
                const isToday =
                    day === today.getDate() &&
                    month === today.getMonth() &&
                    year === today.getFullYear();

                html += `<td data-date="${fullDate}" class="${isToday ? 'today' : ''}">
                             <div>${day}</div>
                             ${hasEval ? `<div class="dot">${data[fullDate].length}</div>` : ''}
                            </td>`;

                if ((firstDay + day) % 7 === 0 && day !== lastDate) html += '</tr><tr>';
            }

            const remainingCells = (firstDay + lastDate) % 7;
            if (remainingCells !== 0) {
                for (let i = remainingCells; i < 7; i++) html += '<td></td>';
            }

            html += '</tr>';
            calendar.innerHTML = html;

            document.querySelectorAll('#calendar td[data-date]').forEach(cell => {
                cell.addEventListener('click', (e) => {
                    addEvaluation(cell.dataset.date);
                });
            });

            renderEvaluations();
        }

        function prevMonth() {
            currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
            renderCalendar();
        }

        function addEvaluation(date) {
            const subject = prompt(`${date} ê³¼ëª© ì…ë ¥:`);
            if (!subject) return;
            const content = prompt(`${date} ë‚´ìš© ì…ë ¥:`);
            if (!content) return;

            if (!data[date]) data[date] = [];
            data[date].push({ subject, content });
            renderCalendar();
        }

        function renderEvaluations() {
            const evalDiv = document.getElementById("evaluations");
            evalDiv.innerHTML = '';
            
            Object.keys(data).sort().forEach(date => {
                data[date].forEach((item, index) => {
                    const emoji = subjectToEmoji(item.subject);
                    const card = document.createElement('div');
                    card.className = 'entry-card';
                    card.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 5px;">
                            <div class="entry-line"><strong>ğŸ“… ë‚ ì§œ:</strong> ${date}</div>
                            <button onclick="removeEvaluationEntry('${date}', ${index})" style="background: none; border: none; padding: 0; margin: 0; cursor: pointer;">
                                <i class="fas fa-times" style="color: #a0a0a0; font-size: 1rem;"></i>
                            </button>
                        </div>
                        <div class="entry-line"><strong>${emoji} ê³¼ëª©:</strong> ${item.subject}</div>
                        <div class="entry-line"><strong>âœ í‰ê°€ ë‚´ìš©:</strong> ${item.content}</div>
                    `;
                    evalDiv.appendChild(card);
                });
            });
        }
        
        function removeEvaluationEntry(date, index) {
            if (confirm(`${date}ì˜ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                if (data[date] && data[date].length > index) {
                    data[date].splice(index, 1);
                    if (data[date].length === 0) {
                        delete data[date];
                    }
                    renderCalendar();
                }
            }
        }


        function saveData() {
            localStorage.setItem("evaluationData", JSON.stringify(data));
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
        }

        function clearData() {
            if (confirm("ëª¨ë“  ìˆ˜í–‰í‰ê°€ ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                data = {};
                localStorage.removeItem("evaluationData");
                renderCalendar();
                alert("ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
            }
        }

        function goHome() {
            window.location.href = "index.html";
        }

        window.onload = function () {
            const saved = localStorage.getItem("evaluationData");
            if (saved) data = JSON.parse(saved);
            renderCalendar();
            
            document.getElementById('prevMonthBtn').addEventListener('click', prevMonth);
            document.getElementById('nextMonthBtn').addEventListener('click', nextMonth);
            document.getElementById('saveDataBtn').addEventListener('click', saveData);
            document.getElementById('clearDataBtn').addEventListener('click', clearData);
            document.getElementById('goHomeBtn').addEventListener('click', goHome);
        };
    </script>
</body>
</html>